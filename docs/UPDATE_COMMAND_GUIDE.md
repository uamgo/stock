# 数据更新命令说明

## 新增功能

已为A股尾盘交易系统添加了数据更新命令 `update`，用于更新股票数据。

## 命令格式

```bash
tail-trading update [OPTIONS]
```

## 参数说明

### 必需参数
无

### 可选参数

- `--top-n N`: 更新前N个涨幅最高的板块 (默认: 10)
- `--skip-minute`: 跳过分钟线数据更新
- `--daily-only`: 仅更新日线数据，不更新分钟线
- `--use-proxy`: 使用代理进行数据获取
- `--concurrent N`: 并发数量 (默认: 20)

## 使用示例

### 基本使用
```bash
# 更新默认top10板块数据
tail-trading update

# 更新top20板块数据
tail-trading update --top-n 20

# 更新top5板块，跳过分钟线数据
tail-trading update --top-n 5 --skip-minute

# 仅更新日线数据
tail-trading update --daily-only

# 使用代理获取数据
tail-trading update --use-proxy

# 设置并发数量
tail-trading update --concurrent 50
```

### 组合使用
```bash
# 更新top15板块，仅日线数据，使用代理
tail-trading update --top-n 15 --daily-only --use-proxy

# 更新top30板块，设置高并发
tail-trading update --top-n 30 --concurrent 100
```

## 更新流程

1. **获取概念板块**: 获取TOP N个涨幅最高的概念板块
2. **获取成员股票**: 获取所有板块的成员股票
3. **保存成员数据**: 将成员股票信息保存到本地
4. **更新日线数据**: 批量更新所有股票的日线数据
5. **更新分钟线数据**: 批量更新所有股票的分钟线数据（可选）

## 数据过滤

系统会自动过滤掉以下股票：
- ST股票和*ST股票
- 退市股票
- 科创板股票（688开头）
- 创业板股票（300开头的某些类型）
- 北交所股票
- 价格过高的股票（>=100元）

## 性能提示

- 默认并发数量为20，可根据网络情况调整
- 使用 `--daily-only` 可以显著减少更新时间
- 使用 `--use-proxy` 可以在网络受限时提高成功率
- 建议在交易时间外进行数据更新以获得最佳性能

## 注意事项

1. 数据更新可能需要较长时间，取决于板块数量和网络状况
2. 建议定期运行数据更新以保持数据的时效性
3. 如果遇到网络问题，可以尝试使用 `--use-proxy` 选项
4. 可以通过 `--verbose` 参数查看详细的错误信息

## 示例输出

```
=== 数据更新系统 ===
更新时间: 2025-07-16 16:02:19
更新板块数量: TOP 10
并发数量: 20
--------------------------------------------------
📊 步骤1: 获取TOP 10涨幅概念板块...
✓ 获取到 10 个概念板块
📈 步骤2: 获取板块成员股票...
✓ 获取到 245 只成员股票
💾 步骤3: 保存成员数据...
✓ 成员数据已保存
📊 步骤4: 更新日线数据...
✓ 日线数据更新完成
⏱️  步骤5: 更新分钟线数据...
✓ 分钟线数据更新完成

📊 更新统计:
  • 板块数量: 10
  • 股票数量: 245
  • 总耗时: 125.45 秒

✅ 数据更新完成
```

这个新功能整合了原有的 `est_prepare_data` 功能，使其能够通过统一的CLI接口进行调用，提高了系统的易用性和一致性。
